<!DOCTYPE html>
<html dir="ltr">
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <title>App/Import/Image databases/Pruning - XOWA</title>
  <link rel="shortcut icon" href="https://gnosygnu.github.io/xowa/xowa_logo.png" />
  <link rel="stylesheet" href="https://gnosygnu.github.io/xowa/xowa_common.css" type="text/css">
  
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject skin-vector action-submit vector-animateLayout" spellcheck="false">
<div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body">
  <h1 id="firstHeading" class="firstHeading"><span>App/Import/Image databases/Pruning</span></h1>
  <div id="bodyContent" class="mw-body-content">
    <div id="siteSub">From XOWA: the free, open-source, offline wiki application</div>
    <div id="contentSub"></div>
    <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
    
    <p>
      XOWA's image databases will accumulate old images and take up unnecessary disk space. This page outlines the process to prune these old images
    </p>
    <h2>
      <span class="mw-headline" id="Background">Background</span>
    </h2>
    <p>
      XOWA releases monthly updates of English Wikipedia images. However, every month, English Wikipedia removes many old images. Over time, the removed images will cause XOWA's image databases to grow larger than necessary.
    </p>
    <p>
      As of 2014-07-07, XOWA's image database for English Wikipedia was 92 GB. It should be 68 GB.
    </p>
    <p>
      If you want to reduce your image database size for English Wikipedia, you can try either of the two options below.
    </p>
    <h2>
      <span class="mw-headline" id="Option_1:_Download_the_updated_set">Option 1: Download the updated set</span>
    </h2>
    <p>
      The simplest approach is to download the <a href="https://archive.org/details/Xowa_enwiki_latest" rel="nofollow" class="external text">latest set</a>. Note that this will require downloading approximately 62 GB of compressed data. Users who have bandwidth issues (caps / low connectivity) may want to look at the next option.
    </p>
    <h2>
      <span class="mw-headline" id="Option_2:_Prune_the_images_manually">Option 2: Prune the images manually</span>
    </h2>
    <p>
      Note the following:
    </p>
    <ul>
      <li>
        This is an advanced step that requires command-line usage
      </li>
      <li>
        It will take anywhere between 2 and 10 hours depending on your machine's speed
      </li>
      <li>
        It works by runing about 200 .sql files on over 90 GB of databases
      </li>
      <li>
        It is the exact same process I used to generate the update set above.
      </li>
    </ul>
    <p>
      The following steps are required:
    </p>
    <ul>
      <li>
        Download the Xowa_enwiki_2014-07-07_prune.7z file at <a href="https://archive.org/details/Xowa_enwiki_latest" rel="nofollow" class="external free">https://archive.org/details/Xowa_enwiki_latest</a> Note that the .7z file is 3 MB.
      </li>
      <li>
        Unzip them to your XOWA root directory. When you are done, you will have a file called <code>/xowa/file/en.wikipedia.org/tmp_sql/en.wikipedia.org-000-atr.sql</code> as well as many others
      </li>
      <li>
        Create a xowa_prune.gfs file in your xowa root with the following text. Note that the file must have UNIX style new lines (Windows users should use a text editor like Notepad++)
      </li>
    </ul>
<pre>
app.bldr.pause_at_end_('n');
app.scripts.run_file_by_type('xowa_cfg_app');
app.bldr.cmds {
  add     ('en.wikipedia.org' , 'file.diff_regy.exec');
}
app.bldr.run;
</pre>
    <ul>
      <li>
        Open up the command line and run the following (change xowa_windows.jar as per your Operating System):
      </li>
    </ul>
<pre>
java -Xmx256m -jar xowa_windows.jar --cmd_file xowa_prune.gfs --app_mode cmd
</pre>
    <p>
      If you run into problems, feel free to contact me as per <a href="/wiki/Help/Feedback" id="xolnki_2" title="Help/Feedback">Help/Feedback</a>
    </p>
  
    </div>
  </div>
</div>


<div id="mw-head" class="noprint">
  <div id="left-navigation">
    <div id="p-namespaces" class="vectorTabs">
      <h3>Namespaces</h3>
      <ul>
        <li  id="ca-nstab-main" class="selected"><span><a id="ca-nstab-main-href" href="index.html">Page</a></span></li>
      </ul>
    </div>
  </div>
</div>

<div id='mw-panel' class='noprint'>
  <div id='p-logo'>
    <a style="background-image: url(https://gnosygnu.github.io/xowa/xowa_logo.png);" href="http://xowa.org/" title="Visit the main page"></a>
  </div>
  <div class="portal" id='xowa-portal-home'>
    <h3>XOWA</h3>
    <div class="body">
      <ul>
        <li><a href="http://xowa.org/index.html" title='Visit the main page'>Main page</a></li>
        <li><a href="http://xowa.org/screenshots.html" title='See screenshots of XOWA'>Screenshots</a></li>
        <li><a href="https://www.youtube.com/watch?v=q0qbXYXEH6M" title="See a video of XOWA Desktop in action">Video</a></li>
        <li><a href="http://xowa.org/home/wiki/Help/Download_XOWA.html" title='Download the XOWA application'>Download XOWA</a></li>
        <li><a href="http://xowa.org/home/wiki/Dashboard/Image_databases.html" title='Download offline wikis and image databases'>Download wikis</a></li>
      </ul>
    </div>
  </div>

  <div class="portal" id='xowa-portal-started'>
    <h3>Getting started</h3>
    <div class="body">
      <ul>
        <li><a href="http://xowa.org/home/wiki/App/Setup/System_requirements.html" title='Get XOWA&apos;s system requirements'>Requirements</a></li>
        <li><a href="http://xowa.org/home/wiki/App/Setup/Installation.html" title='Get instructions for installing XOWA'>Installation</a></li>
        <li><a href="http://xowa.org/home/wiki/App/Import/Simple_Wikipedia.html" title='Learn how to set up Simple Wikipedia'>Simple Wikipedia</a></li>
        <li><a href="http://xowa.org/home/wiki/App/Import/English_Wikipedia.html" title='Learn how to set up English Wikipedia'>English Wikipedia</a></li>
        <li><a href="http://xowa.org/home/wiki/App/Import/Other_wikis.html" title='Learn how to set up other Wikipedias'>Other Wikipedias</a></li>
      </ul>
    </div>
  </div>

  <div class="portal" id='xowa-portal-android'>
    <h3>Android</h3>
    <div class="body">
      <ul>
        <li><a href="http://xowa.org/home/wiki/Android/Setup.html" title='Setup XOWA on your Android device'>Setup</a></li>
        <li><a href="https://www.youtube.com/watch?v=jsMTBxGweUw" title="See a video of XOWA Android in action">Video</a></li>
      </ul>
    </div>
  </div>

  <div class="portal" id='xowa-portal-help'>
    <h3>Help</h3>
    <div class="body">
      <ul>
        <li><a href="http://xowa.org/home/wiki/Help/About.html" title='Get more information about XOWA'>About</a></li>
        <li><a href="http://xowa.org/home/wiki/Help/Contents.html" title='View a list of help topics'>Contents</a></li>
        <li><a href="http://xowa.org/home/wiki/Help/Media.html" title='Read what others have written about XOWA'>Media</a></li>
        <li><a href="http://xowa.org/home/wiki/Help/Feedback.html" title='Questions? Comments? Leave feedback for XOWA'>Feedback</a></li>
      </ul>
    </div>
  </div>
  
  <div class="portal" id='xowa-portal-blog'>
    <h3>Blog</h3>
    <div class="body">
      <ul>
        <li><a href="http://xowa.org/home/wiki/Blog.html" title='Follow XOWA''s development process'>Current</a></li>
      </ul>
    </div>
  </div>

  <div class="portal" id='xowa-portal-links'>
    <h3>Links</h3>
    <div class="body">
      <ul>
        <li><a href="http://dumps.wikimedia.org/backup-index.html" title="Get wiki datababase dumps directly from Wikimedia">Wikimedia dumps</a></li>
        <li><a href="https://archive.org/search.php?query=xowa" title="Search archive.org for XOWA files">XOWA @ archive.org</a></li>
        <li><a href="http://en.wikipedia.org" title="Visit Wikipedia (and compare to XOWA!)">English Wikipedia</a></li>
      </ul>
    </div>
  </div>

  <div class="portal" id='xowa-portal-donate'>
    <h3>Donate</h3>
    <div class="body">
      <ul>
        <li><a href="https://archive.org/donate/index.php" title="Support archive.org!">archive.org</a></li><!-- listed first due to recent fire damages: http://blog.archive.org/2013/11/06/scanning-center-fire-please-help-rebuild/ -->
        <li><a href="https://donate.wikimedia.org/wiki/Special:FundraiserRedirector" title="Support Wikipedia!">Wikipedia</a></li>
        <li><a href="http://xowa.org/home/wiki/Help/Donate.html" title="Support XOWA!">XOWA</a></li>
      </ul>
    </div>
  </div>
  
</div>
</body>
</html>